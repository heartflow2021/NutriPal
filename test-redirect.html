<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>跳轉測試</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div style="padding: 20px; text-align: center;">
        <h1>跳轉測試頁面</h1>
        <p>這個頁面用於測試從chat.html到results.html的跳轉功能</p>
        
        <button id="save-data" style="margin: 20px 0; padding: 10px 20px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">
            1. 儲存測試資料
        </button>
        
        <button id="redirect-test" style="margin: 20px 0; padding: 10px 20px; background-color: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer;">
            2. 直接跳轉到結果頁
        </button>
        
        <button id="form-submit" style="margin: 20px 0; padding: 10px 20px; background-color: #FF9800; color: white; border: none; border-radius: 4px; cursor: pointer;">
            3. 表單提交跳轉
        </button>
        
        <div id="status" style="margin-top: 20px; padding: 10px; background-color: #f1f1f1; border-radius: 4px;"></div>
    </div>
    
    <script>
        // 測試資料
        const testData = {
            products: [
                {
                    id: "test1",
                    name: "測試產品1",
                    brand: "測試品牌",
                    description: "這是一個測試產品。",
                    price: 350,
                    rating: 4.6,
                    image_url: "https://via.placeholder.com/150",
                    benefits: ["測試功效1", "測試功效2"],
                    usage: "測試用法",
                    caution: "測試注意事項",
                    ingredients: "測試成分",
                    health_needs: ["改善睡眠品質"],
                    lifestyle_match: ["長時間工作"]
                }
            ],
            userHealthNeed: "改善睡眠品質",
            userLifestyle: "長時間工作",
            userBudget: 1000
        };
        
        document.getElementById('save-data').addEventListener('click', function() {
            try {
                // 儲存資料到 sessionStorage
                sessionStorage.setItem('recommendedProducts', JSON.stringify(testData.products));
                sessionStorage.setItem('userHealthNeed', testData.userHealthNeed);
                sessionStorage.setItem('userLifestyle', testData.userLifestyle);
                sessionStorage.setItem('userBudget', testData.userBudget);
                
                // 顯示狀態
                document.getElementById('status').textContent = '資料已成功儲存到 sessionStorage';
            } catch (err) {
                document.getElementById('status').textContent = '儲存資料時出錯: ' + err.message;
            }
        });
        
        document.getElementById('redirect-test').addEventListener('click', function() {
            try {
                // 直接跳轉
                document.getElementById('status').textContent = '正在嘗試直接跳轉...';
                
                // 使用完整網址跳轉，避免相對路徑問題
                const baseUrl = window.location.href.substring(0, window.location.href.lastIndexOf('/') + 1);
                const redirectUrl = baseUrl + 'results.html';
                
                console.log('跳轉到URL:', redirectUrl);
                window.location.href = redirectUrl;
            } catch (err) {
                document.getElementById('status').textContent = '跳轉時出錯: ' + err.message;
            }
        });
        
        document.getElementById('form-submit').addEventListener('click', function() {
            try {
                // 表單提交方式跳轉
                document.getElementById('status').textContent = '正在嘗試通過表單提交跳轉...';
                
                // 創建一個表單
                const form = document.createElement('form');
                form.method = 'get';
                form.action = 'results.html';
                
                // 添加欄位
                const fields = {
                    'health': testData.userHealthNeed,
                    'lifestyle': testData.userLifestyle,
                    'budget': testData.userBudget,
                    'time': new Date().getTime()
                };
                
                // 添加欄位到表單
                for (const [name, value] of Object.entries(fields)) {
                    const input = document.createElement('input');
                    input.type = 'hidden';
                    input.name = name;
                    input.value = value;
                    form.appendChild(input);
                }
                
                // 添加到頁面並提交
                document.body.appendChild(form);
                form.submit();
            } catch (err) {
                document.getElementById('status').textContent = '表單提交跳轉時出錯: ' + err.message;
            }
        });
    </script>
</body>
</html> 